<?php	$username=$_POST['username'];	$pwd=$_POST['passwd'];	$db=$_POST['db'];	$host=$_POST['host'];	$serverip=$_SERVER['SERVER_ADDR'];	$path=dirname(dirname($_SERVER['PHP_SELF']));	$hint=($_POST['hints'] == true?'true':'false');	$con = mysql_connect($host,$username,$pwd);	// TODO: AI issue #3, High, Cross-site Scripting, https://github.com/rbm1718/bricks/issues/3	//	// POST /config/config.php HTTP/1.1	// Host: localhost	// Accept-Encoding: identity	// Connection: close	// Content-Length: 42	// Content-Type: application/x-www-form-urlencoded	//	// db=%3Cscript%3Ealert%281%29%3C%2Fscript%3E	//	// (!mysql_select_db('<script>alert(1)</script>', mysql_connect($_POST['host'], $_POST['username'], $_POST['passwd'])))	@mysql_select_db($db,$con) or die( "Unable to connect to the database: $db");	if ($con)	{  		if(isset($_POST['submit'])) {			header('Content-Disposition: attachment; filename="LocalSettings.php"');			$var = "<?php# This file was automatically generated by the Bricks installer. # If you make manual changes, please keep track in case you need to recreate them later.\$dbuser = '$username'; //MySQL database username\$dbpass = '$pwd'; //MySQL database password\$dbname = '$db';  //MySQL database name\$host = '$host';  //MySQL database host\$showhint = $hint;  //Shows the last executed SQL query\$server = 'http://$serverip';  //The protocol and server name to use in fully-qualified URLs\$scriptpath = '$path';?>";			// TODO: AI issue #3, High, Cross-site Scripting, https://github.com/rbm1718/bricks/issues/3			//			// POST /config/config.php HTTP/1.1			// Host: localhost			// Accept-Encoding: identity			// Connection: close			// Content-Length: 108			// Content-Type: application/x-www-form-urlencoded			//			// db=&hints=935137890000&host=&passwd=&submit=935137890000&username=%3E%3Cscript%3Ealert%281%29%3C%2Fscript%3E			//			// mysql_select_db('', True)			// $_SERVER['SERVER_ADDR'] == ''			// TODO: AI issue #3, High, Cross-site Scripting, https://github.com/rbm1718/bricks/issues/3			//			// POST /config/config.php HTTP/1.1			// Host: localhost			// Accept-Encoding: identity			// Connection: close			// Content-Length: 89			// Content-Type: application/x-www-form-urlencoded			//			// db=&host=&passwd=&submit=935137890000&username=%3E%3Cscript%3Ealert%281%29%3C%2Fscript%3E			//			// mysql_select_db('', True)			// $_SERVER['SERVER_ADDR'] == ''			// TODO: AI issue #3, High, Cross-site Scripting, https://github.com/rbm1718/bricks/issues/3			//			// POST /config/config.php HTTP/1.1			// Host: localhost			// Accept-Encoding: identity			// Connection: close			// Content-Length: 108			// Content-Type: application/x-www-form-urlencoded			//			// db=&hints=935137890000&host=&passwd=%3E%3Cscript%3Ealert%281%29%3C%2Fscript%3E&submit=935137890000&username=			//			// mysql_select_db('', True)			// $_SERVER['SERVER_ADDR'] == ''			// TODO: AI issue #3, High, Cross-site Scripting, https://github.com/rbm1718/bricks/issues/3			//			// POST /config/config.php HTTP/1.1			// Host: localhost			// Accept-Encoding: identity			// Connection: close			// Content-Length: 89			// Content-Type: application/x-www-form-urlencoded			//			// db=&host=&passwd=%3E%3Cscript%3Ealert%281%29%3C%2Fscript%3E&submit=935137890000&username=			//			// mysql_select_db('', True)			// $_SERVER['SERVER_ADDR'] == ''			// TODO: AI issue #3, High, Cross-site Scripting, https://github.com/rbm1718/bricks/issues/3			//			// POST /config/config.php HTTP/1.1			// Host: localhost			// Accept-Encoding: identity			// Connection: close			// Content-Length: 108			// Content-Type: application/x-www-form-urlencoded			//			// db=%3E%3Cscript%3Ealert%281%29%3C%2Fscript%3E&hints=935137890000&host=&passwd=&submit=935137890000&username=			//			// mysql_select_db('><script>alert(1)</script>', True)			// $_SERVER['SERVER_ADDR'] == ''			// TODO: AI issue #3, High, Cross-site Scripting, https://github.com/rbm1718/bricks/issues/3			//			// POST /config/config.php HTTP/1.1			// Host: localhost			// Accept-Encoding: identity			// Connection: close			// Content-Length: 89			// Content-Type: application/x-www-form-urlencoded			//			// db=%3E%3Cscript%3Ealert%281%29%3C%2Fscript%3E&host=&passwd=&submit=935137890000&username=			//			// mysql_select_db('><script>alert(1)</script>', True)			// $_SERVER['SERVER_ADDR'] == ''			// TODO: AI issue #3, High, Cross-site Scripting, https://github.com/rbm1718/bricks/issues/3			//			// POST /config/config.php HTTP/1.1			// Host: localhost			// Accept-Encoding: identity			// Connection: close			// Content-Length: 108			// Content-Type: application/x-www-form-urlencoded			//			// db=&hints=935137890000&host=%3E%3Cscript%3Ealert%281%29%3C%2Fscript%3E&passwd=&submit=935137890000&username=			//			// mysql_select_db('', True)			// $_SERVER['SERVER_ADDR'] == ''			// TODO: AI issue #3, High, Cross-site Scripting, https://github.com/rbm1718/bricks/issues/3			//			// POST /config/config.php HTTP/1.1			// Host: localhost			// Accept-Encoding: identity			// Connection: close			// Content-Length: 89			// Content-Type: application/x-www-form-urlencoded			//			// db=&host=%3E%3Cscript%3Ealert%281%29%3C%2Fscript%3E&passwd=&submit=935137890000&username=			//			// mysql_select_db('', True)			// $_SERVER['SERVER_ADDR'] == ''			print $var;		}	} else {	die('Could not connect: ' . mysql_error());			}?>